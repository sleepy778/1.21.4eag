<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Minecraft Browser Client</title>
</head>
<body>
    <h1>Minecraft Browser Client</h1>
    <button id="loginBtn">Sign in with Microsoft</button>
    <script>
        let sessionId = null;

        // Handle popup message
        window.addEventListener("message", (e) => {
            if (e.data.sessionId) {
                sessionId = e.data.sessionId;
                console.log("Logged in! Session:", sessionId);
                connectToServer();
            }
        });

        document.getElementById("loginBtn").onclick = () => {
            window.open("/login", "_blank", "width=500,height=600");
        };

        function connectToServer() {
            const ws = new WebSocket("ws://localhost:8080");
            ws.onopen = () => {
                ws.send(JSON.stringify({
                    sessionId,
                    host: "play.hypixel.net",
                    port: 25565
                }));
            };
            ws.onmessage = (event) => {
                console.log("Packet from server:", event.data);
            };
        }
    </script>
</body>
</html>
